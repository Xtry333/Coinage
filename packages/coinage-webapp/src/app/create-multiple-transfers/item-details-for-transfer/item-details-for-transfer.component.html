@if (itemsLoaded) {
    <div class="add-items-to-transfer ml-5">
        <div class="grid grid-cols-1 gap-3 pb-3 md:grid-cols-3">
            <div>
                <label class="mb-2 block text-sm font-medium text-gray-700" for="selectedItemInput">Item</label>
                <ng-select
                    #itemSelect
                    [(ngModel)]="selectedItemDetails.id"
                    [clearable]="true"
                    [editableSearchTerm]="true"
                    [items]="allItems"
                    [searchable]="true"
                    [notFoundText]="'No items found'"
                    [required]="true"
                    (change)="onItemSelected($event)"
                    name="itemId"
                    labelForId="selectedItemInput"
                    placeholder="Search"
                    bindValue="id"
                    bindLabel="name"
                    aria-label="Search for item"
                ></ng-select>
            </div>
            <div>
                <label class="mb-2 block text-sm font-medium text-gray-700" for="selectedItemContainerInput">Container</label>
                <ng-select
                    #containerSelect
                    [(ngModel)]="selectedItemDetails.id"
                    [clearable]="true"
                    [editableSearchTerm]="true"
                    [items]="allContainers"
                    [required]="false"
                    [searchable]="true"
                    [notFoundText]="'No containers found'"
                    (change)="onContainerSelected($event)"
                    name="containerId"
                    labelForId="selectedItemContainerInput"
                    placeholder="Search"
                    bindValue="id"
                    bindLabel="name"
                    aria-label="Search for container"
                ></ng-select>
            </div>
            <div>
                <label class="mb-2 block text-sm font-medium text-gray-700" for="setDiscountInput">Set discount</label>
                <div class="flex">
                    <input
                        class="flex-1 rounded-l-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        id="setDiscountInput"
                        [(ngModel)]="selectedItemDetails.setDiscount"
                        (change)="onItemDetailsChanged()"
                        type="number"
                        min="0"
                        step="0.01"
                        placeholder="0.00"
                        aria-describedby="setDiscountInput"
                    />
                    <span class="rounded-r-md border border-l-0 border-gray-300 bg-gray-50 px-3 py-2 text-sm text-gray-500" id="setDiscountInput">zł</span>
                </div>
            </div>
        </div>
        <div class="mb-3 grid grid-cols-1 gap-3 md:grid-cols-3">
            <div>
                <label class="mb-2 flex items-center justify-between text-sm font-medium text-gray-700" for="unitPriceInput">
                    <span>Unit Price</span>
                    @if (canAutoAdjustUnitPrice) {
                        <fa-icon
                            class="auto-adjust-icon"
                            [icon]="autoAdjustIcon"
                            [fixedWidth]="true"
                            [title]="autoAdjustTitleText"
                            [ariaLabel]="autoAdjustTitleText"
                        ></fa-icon>
                    }
                </label>
                <div class="flex">
                    <input
                        class="flex-1 rounded-l-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        id="unitPriceInput"
                        [(ngModel)]="selectedItemDetails.unitPrice"
                        (change)="onUnitPriceChanged()"
                        (focus)="onUnitPriceChanged()"
                        type="number"
                        required="true"
                        min="0"
                        step="0.01"
                        placeholder="1.00"
                        autocomplete="off"
                        aria-describedby="unitPriceInputAddon"
                    />
                    <span class="rounded-r-md border border-l-0 border-gray-300 bg-gray-50 px-3 py-2 text-sm text-gray-500" id="unitPriceInputAddon">zł</span>
                </div>
            </div>
            <div>
                <label class="mb-2 flex items-center justify-between text-sm font-medium text-gray-700" for="amountInput">
                    <span>Amount</span>
                    @if (canAutoAdjustAmount) {
                        <fa-icon
                            class="auto-adjust-icon"
                            [icon]="autoAdjustIcon"
                            [fixedWidth]="true"
                            [title]="autoAdjustTitleText"
                            [ariaLabel]="autoAdjustTitleText"
                        ></fa-icon>
                    }
                </label>
                <div class="flex">
                    <input
                        class="flex-1 rounded-l-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        id="amountInput"
                        [(ngModel)]="selectedItemDetails.amount"
                        (change)="onAmountChanged()"
                        (focus)="onAmountChanged()"
                        type="number"
                        required="true"
                        min="0"
                        value="1"
                        placeholder="1.00"
                        aria-describedby="amountInputAddon"
                    />
                    <span class="rounded-r-md border border-l-0 border-gray-300 bg-gray-50 px-3 py-2 text-sm text-gray-500" id="amountInputAddon">X</span>
                </div>
            </div>
            <div>
                <label class="mb-2 flex items-center justify-between text-sm font-medium text-gray-700" for="totalPriceInput">
                    <span>Total Price <span class="text-gray-500">(not including discount)</span></span>
                    @if (canAutoAdjustTotalPrice) {
                        <fa-icon
                            class="auto-adjust-icon"
                            [icon]="autoAdjustIcon"
                            [fixedWidth]="true"
                            [title]="autoAdjustTitleText"
                            [ariaLabel]="autoAdjustTitleText"
                        ></fa-icon>
                    }
                </label>
                <div class="flex">
                    <input
                        class="flex-1 rounded-l-md border border-gray-300 px-3 py-2 focus:border-blue-500 focus:outline-none focus:ring-2 focus:ring-blue-500"
                        id="totalPriceInput"
                        [(ngModel)]="selectedItemDetails.totalPrice"
                        (change)="onTotalPriceChanged()"
                        (focus)="onTotalPriceChanged()"
                        type="number"
                        required="true"
                        min="0"
                        step="0.01"
                        placeholder="1.00"
                        autocomplete="off"
                        aria-describedby="totalPriceInputAddon"
                    />
                    <span class="rounded-r-md border border-l-0 border-gray-300 bg-gray-50 px-3 py-2 text-sm text-gray-500" id="totalPriceInputAddon">zł</span>
                </div>
            </div>
        </div>
        <div class="mb-3">
            <div class="flex justify-center">
                @if (selectedItemDetails.name) {
                    <span class="text-gray-500">{{ itemDetailsInfo }}</span>
                }
            </div>
        </div>
        <div class="flex justify-center">
            <div class="w-full max-w-md">
                <button
                    class="w-full rounded-md border border-gray-300 bg-white px-4 py-2 text-gray-700 transition duration-200 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2"
                    (click)="onClickAddNewItemToList()"
                    type="button"
                >
                    Add
                </button>
            </div>
        </div>
    </div>
}
