<div class="selected-items">
    <ul class="w-full overflow-hidden rounded-md border border-gray-200">
        @for (category of categorisedItemList; track category) {
            <li class="border-b border-gray-200 p-0">
                <div class="flex justify-between px-2 pt-2">
                    <div class="font-bold">{{ category.name }}</div>
                    <span class="rounded-full bg-blue-500 px-2 py-1 text-sm text-white">{{ category.items.length }}</span>
                </div>
                <ul class="border-t border-gray-200">
                    @for (item of category.items; track item) {
                        <li class="border-b border-gray-200 p-2">
                            <div class="grid grid-cols-12 gap-2">
                                <div class="col-span-6">
                                    <div class="flex justify-between">
                                        <span>{{ item.name }}</span>
                                        <fa-icon
                                            class="remove-icon"
                                            [icon]="removeIcon"
                                            [fixedWidth]="true"
                                            [ariaLabel]="'Remove item from list'"
                                            (click)="removeItem(item)"
                                        ></fa-icon>
                                    </div>
                                </div>
                                <div class="col text-right">
                                    <span>{{ item.unitPrice | plnCurrency }} x {{ item.amount }}</span>
                                </div>
                                <div class="col text-right">
                                    <div>
                                        <span>{{ getItemTotalPrice(item) | plnCurrency }}</span>
                                    </div>
                                    @if (item.setDiscount && item.setDiscount > 0) {
                                        <div>
                                            <span [title]="getItemTotalPriceWithDiscount(item) | plnCurrency">{{ -item.setDiscount | plnCurrency }}</span>
                                        </div>
                                    }
                                </div>
                            </div>
                        </li>
                    }
                    @if (categorisedItemList.length > 1) {
                        <li class="category-sum border-b border-gray-200 p-2">
                            <div class="text-right">{{ getTotalCategoryCost(category.items) | plnCurrency }}</div>
                        </li>
                    }
                </ul>
            </li>
        }
        <li class="border-b border-gray-200 p-2">
            <div class="grid grid-cols-12 gap-2">
                @if (items.length === 0) {
                    <div>There are no items added.</div>
                }
                @if (items.length > 0) {
                    <div class="col-span-6">
                        <span class="font-bold">Grand Total</span>
                    </div>
                }
                <div class="col text-right">{{ getItemsCost(items) | plnCurrency }}</div>
            </div>
        </li>
    </ul>
</div>
