@if (itemsLoaded) {
    <div class="ml-5">
        <div class="add-items-to-transfer-form">
            <div class="item-input-id">
                <label class="block text-sm font-medium text-gray-700" for="itemId">Item</label>
                <ng-select
                    #itemSelect
                    [(ngModel)]="selectedItem.id"
                    [clearable]="true"
                    [required]="false"
                    [editableSearchTerm]="true"
                    [items]="searchableItems"
                    [addTag]="onAddNewItem.bind(this)"
                    (change)="onItemSelected($event)"
                    name="itemId"
                    labelForId="itemId"
                    bindValue="id"
                    bindLabel="name"
                >
                </ng-select>
            </div>
            <div class="item-input-price">
                <label class="block text-sm font-medium text-gray-700" for="itemPrice">Price</label>
                <input
                    class="block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"
                    id="itemPrice"
                    [(ngModel)]="selectedItem.price"
                    name="itemPrice"
                    type="number"
                    min="0"
                    step="0.01"
                    placeholder="0.00"
                />
            </div>
            <div class="item-input-amount">
                <label class="block text-sm font-medium text-gray-700" for="itemAmount">Amount</label>
                <input
                    class="block w-full rounded-md border border-gray-300 px-3 py-2 shadow-sm focus:border-blue-500 focus:outline-none focus:ring-blue-500 sm:text-sm"
                    id="itemAmount"
                    [(ngModel)]="selectedItem.amount"
                    name="itemAmount"
                    type="number"
                    min="0"
                    step="0.01"
                    placeholder="1"
                />
            </div>
            <div class="item-input-container">
                <label class="block text-sm font-medium text-gray-700" for="containerId">Container</label>
                <ng-select
                    #containerSelect
                    [(ngModel)]="selectedItem.containerId"
                    [clearable]="true"
                    [required]="false"
                    [items]="containersWithDisplayNames"
                    name="containerId"
                    labelForId="containerId"
                    bindValue="id"
                    bindLabel="displayName"
                    placeholder="Select container (optional)"
                >
                </ng-select>
            </div>
        </div>
        <button
            class="inline-flex items-center justify-center rounded-md bg-blue-600 px-4 py-2 text-sm font-medium text-white transition-colors duration-200 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:cursor-not-allowed disabled:bg-gray-400"
            (click)="onClickAddNewItemToList()"
        >
            <svg class="mr-2 h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6v6m0 0v6m0-6h6m-6 0H6"></path>
            </svg>
            Add Item
        </button>
        <div class="shopping-list">
            <ol>
                @for (item of itemList; track item; let i = $index) {
                    <li class="shopping-item inline-editable">
                        <div class="item-details">
                            <div class="item-name">{{ item.name | ifNull: 'Unnamed' }}</div>
                            <div class="item-inputs">
                                <label class="sr-only">Quantity</label>
                                <input
                                    class="quantity-input"
                                    [(ngModel)]="item.amount"
                                    (ngModelChange)="onItemQuantityChanged(item)"
                                    type="number"
                                    min="0.01"
                                    step="0.01"
                                    placeholder="Qty"
                                />
                                <span class="multiply-symbol">Ã—</span>
                                <label class="sr-only">Price</label>
                                <input
                                    class="price-input"
                                    [(ngModel)]="item.price"
                                    (ngModelChange)="onItemPriceChanged(item)"
                                    type="number"
                                    min="0"
                                    step="0.01"
                                    placeholder="Price"
                                />
                                <span class="equals-symbol">=</span>
                                <span class="total-price">{{ item.amount * item.price | plnCurrency }}</span>
                            </div>
                            <div class="container-selection">
                                <label class="sr-only">Container</label>
                                <ng-select
                                    class="container-select"
                                    [(ngModel)]="item.containerId"
                                    [clearable]="true"
                                    [searchable]="false"
                                    [items]="containersWithDisplayNames"
                                    (ngModelChange)="onItemContainerChanged(item)"
                                    bindValue="id"
                                    bindLabel="displayName"
                                    placeholder="Container (optional)"
                                >
                                </ng-select>
                            </div>
                        </div>
                        <span (click)="onRemoveItemFromList(item)"><fa-icon class="remove-icon" [icon]="removeIcon" [fixedWidth]="true"></fa-icon></span>
                    </li>
                }
            </ol>
        </div>
    </div>
}
